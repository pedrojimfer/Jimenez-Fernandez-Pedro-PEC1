---
title: "Jimenez-Ferandez-Pedro-PEC1"
author: "Pedro Jiménez Fernández"
date: "2025-03-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Abstract

Resumen de lo que es la cachexia, y breve descripción de lo que se hace en este estudio

# Objetivos

Creación del objeto de tipo summarizedExperiment a partir del conjunto de datos proporcionado, objetivos del análisis estadístico.

# Métodos

RStudio, RMarkdown y librerías empleadas, construcción de objeto de tipo summarizedExperiment, métodos estadísticos empleados

# Resultados

## Importación de los datos

En primer lugar se descargan los datos.

```{r}
# descarga de los datos
if (!require("curl", quietly = TRUE)) {
  install.packages("curl")
}
library(curl)
curl::curl_download(url = "https://raw.githubusercontent.com/nutrimetabolomics/metaboData/refs/heads/main/Datasets/2024-Cachexia/human_cachexia.csv", destfile = "human_cachexia.csv")
```

Una vez descargados los datos en el repositorio, se importan para su posterior análisis.

```{r}
# importación de los datos
cachexia_data <- read.csv(file = "human_cachexia.csv")
# a continuación se separan los datos de los metadatos
patient_id <- cachexia_data[1:nrow(cachexia_data), 1]
muscle_loss <- cachexia_data[1:nrow(cachexia_data), 2]
data <- cachexia_data[1:nrow(cachexia_data), 3:ncol(cachexia_data)]
metabolites <- colnames(data)
# para que los datos sean de tipo numérico se guardan en la variable
# data como un objeto de tipo matriz
data <- as.matrix(data)
```

## Creación del objeto SummarizedExperiment

```{r}
# Una vez se tienen separados por una parte los datos y por otra los
# metadatos en distintas variables, se crea el objeto
# SummarizedExperiment. Para ello, primero se instala la librería en
# caso de no estar instalada y se carga.
# Se instala BiocManager en caso de no estar instalado
if (!require("BiocManager", quietly = TRUE)) {
  install.packages("BiocManager")
  BiocManager::install(version = "3.20")
}
# se instala SummarizedExperiment en caso de no estar instalado
if (!requireNamespace("SummarizedExperiment", quietly = TRUE)) {
  BiocManager::install("SummarizedExperiment")
}
# se carga la librería SummarizdExperiment
library(SummarizedExperiment)
# una vez cargada la librería, se procede a la creación del objeto de
# tipo SummarizedExperiment.
# En primer lugar, se transpone la matriz de datos para que los metabolitos
# aparezcan como filas, esto se hace para seguir la estructura convencional
# de BioConductor
data <- t(data)
row.names(data) = metabolites
colnames(data) = patient_id
# se crean los metadatos de las columnas
col_data <- DataFrame(patient_id = patient_id, group = muscle_loss)
rownames(col_data) <- patient_id
# se crean los metadatos de las filas
row_data <- DataFrame(metabolite_name = metabolites)
rownames(row_data) <- metabolites
# se crean una serie de metadatos generales con breve información de
# los datos
meta <- list(
  title = "Perfil metabolómico en pacientes con cachexia",
  grupos = "Control: sin cachexia, Cachexia: con cachexia",
  fuente = "https://raw.githubusercontent.com/nutrimetabolomics/metaboData/refs/heads/main/Datasets/2024-Cachexia/human_cachexia.csv",
  fecha = Sys.Date()
)
# y finalmente se crea el objeto SummarizedExperiment
cachexia_se <- SummarizedExperiment(
  assays = list(metabolites = data),
  rowData = row_data,
  colData = col_data,
  metadata = meta
)
# se visualiza el objeto SummarizedExperiment
cachexia_se
```

Tal y como se puede observar, la variable "cachexia_se" contiene 63 variables (metabolitos) y 77 observaciones (pacientes/individuos sanos) distribuídas en filas y columnas respectivamente.

## Análisis exploratorio de los datos y PCA (principal component analysis)

A continuación se hace un análisis exploratorio de los datos contenidos en el objeto "cachexia_se".

```{r}
# resumen de los diferentes grupos
table(colData(cachexia_se)$group)
```

Se puede observar que en total hay 47 individuos con cachexia y 30 individuos pertenecientes al grupo control.

```{r}
# resumen estadístico básico de los metabolitos:
## primero se construye un dataframe
met_data <- assay(cachexia_se)
stats <- data.frame(
  metabolite = rownames(met_data),
  mean = rowMeans(met_data),
  sd = rowSds(met_data),
  median = rowMedians(met_data),
  min = rowMins(met_data),
  max = rowMaxs(met_data)
)
## se muestran las estadísticas descriptivas básicas ds los 10 metabolitos con
## niveles medios más altos
head(stats[order(-stats$mean), ], n = 10)

```

Los 3 metabolitos con niveles medios más altos son son la creatinina, el hipurato y el citrato. `comprobar la diferencia del nivel de estos 3 metabolitos entre el grupo control y el grupo cachexia, plantear un contraste de hipótesis`.
